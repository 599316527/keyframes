function EventEmitter(){this._routes={}}EventEmitter.type={once:"once",all:"all"},EventEmitter.prototype.on=function(t,e,i){if(!t)throw new Error("undefined event！");t in this._routes?this._routes[t].push({fn:e,option:i}):this._routes[t]=[{fn:e,option:i}],this.emit(Event.on,t,i)},EventEmitter.prototype.off=function(t,e){if(Checker.string.check(arguments))t in this._routes&&(this._routes[t]=[],this.emit(Event.off,t));else{if(!Checker.sFunction.check(arguments))throw new Error("incorrect parameter!");if(t in this._routes){var i=-1;Util.each(this._routes[t],function(t,n){return t.fn===e?(i=n,!1):void 0}),i>-1&&(this._routes[t].splice(i,1),this.emit(Event.off,t))}}},EventEmitter.prototype.once=function(t,e,i){i||(i={}),i.type=EventEmitter.type.once,this.emit(Event.once,t,i),this.on(t,e,i)},EventEmitter.prototype.callWithScope=function(t,e,i){i=i||[],e&&"scope"in e?t.apply(e.scope,i):t.apply(this,i)},EventEmitter.prototype.all=function(t,e,i){var n={},o=[];if(0===t.length)return void this.callWithScope(e,i);var r=this,s=function(t){return function(s,h){s in n&&(n[s]=!0,o[t]=h);var p=!0;for(var c in n)if(n[c]===!1){p=!1;break}p&&r.callWithScope(e,i,o)}};Util.each(t,function(t,e){n[t]=!1,this.on(t,s(e),{type:EventEmitter.type.all})}),this.emit(Event.all,t,i)},EventEmitter.prototype.emit=function(t){var e,i,n,o,r,s,h=this._routes[t],p=[],c=arguments;if(h){var u=this;if(Util.each(h,function(t){o=t.fn,r=t.option,r?(i=r.scope,n=r.type):(i=!1,n=!1),i?o.apply(i,Util.arg2Ary(c)):o.apply(u,Util.arg2Ary(c)),n&&p.push(t)}),p.length>0){var f=[],l=0,a=0,E=h.length,v=p.length;for(s=p[a];E>l;)e=h[l],e===s?(a++,s=v>a?p[a]:-1):f.push(e),l++;0===f.length?delete this._routes[t]:this._routes[t]=f}}};