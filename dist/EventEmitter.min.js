function EventEmitter(){this._triggers={}}EventEmitter.type={once:"once",all:"all"},EventEmitter.prototype.on=function(t,e,i){if(!t)throw new Error("undefined event!");t in this._triggers?this._triggers[t].push({fn:e,option:i}):this._triggers[t]=[{fn:e,option:i}],this.emit(Event.on,t,i)},EventEmitter.prototype.off=function(t,e){if(Checker.string.check(arguments))t in this._triggers&&(this._triggers[t]=[],this.emit(Event.off,t));else{if(!Checker.sFunction.check(arguments))throw new Error("incorrect parameter!");if(t in this._triggers){var i=-1;Util.each(this._triggers[t],function(t,n){return t.fn===e?(i=n,!1):void 0}),i>-1&&(this._triggers[t].splice(i,1),this.emit(Event.off,t))}}},EventEmitter.prototype.once=function(t,e,i){i||(i={}),i.type=EventEmitter.type.once,this.emit(Event.once,t,i),this.on(t,e,i)},EventEmitter.prototype.callWithScope=function(t,e,i){i=i||[],e&&e.hasOwnProperty("scope")?t.apply(e.scope,i):t.apply(this,i)},EventEmitter.prototype.all=function(t,e,i){var n={},r=[];if(0===t.length)return void this.callWithScope(e,i);var o=this,s=function(t){return function(s,h){s in n&&(n[s]=!0,r[t]=h);var p=Util.forIn(n,function(t,e){return e===!1?!1:void 0});p&&o.callWithScope(e,i,r)}};Util.each(t,function(t,e){n[t]=!1,this.on(t,s(e),{type:EventEmitter.type.all})},o),this.emit(Event.all,t,i)},EventEmitter.prototype.emit=function(t){var e,i,n,r,o=this._triggers[t],s=[],h=arguments;if(o){var p=this;if(Util.each(o,function(t){n=t.fn,r=t.option,r?(e=r.scope,i=r.type):(e=!1,i=!1),e?n.apply(e,Util.arg2Ary(h)):n.apply(p,Util.arg2Ary(h)),i&&s.push(t)}),s.length>0){var c,g,l=[],f=0,a=0,E=o.length,v=s.length;for(c=s[a];E>f;)g=o[f],g===c?(a++,c=v>a?s[a]:-1):l.push(g),f++;0===l.length?delete this._triggers[t]:this._triggers[t]=l}}};