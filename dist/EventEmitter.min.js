function EventEmitter(){this._routes={}}EventEmitter.event={once:"once",all:"all"},EventEmitter.prototype.on=function(t,e,n){t in this._routes?this._routes[t].push({fn:e,option:n}):this._routes[t]=[{fn:e,option:n}]},EventEmitter.prototype.once=function(t,e,n){n||(n={}),n.type=EventEmitter.event.once,this.on(t,e,n)},EventEmitter.prototype.callWithScope=function(t,e,n){n=n||[],e&&"scope"in e?t.apply(e.scope,n):t.apply(this,n)},EventEmitter.prototype.all=function(t,e,n){var o,i,r={},p=[],l=t.length;if(0===l)return void this.callWithScope(e,n);for(i=0;l>i;i++)o=t[i],r[o]=!1;var s=this,h=function(t){return function(o,i){o in r&&(r[o]=!0,p[t]=i);var l=!0;for(var h in r)if(r[h]===!1){l=!1;break}l&&s.callWithScope(e,n,p)}};for(i=0;l>i;i++)o=t[i],this.on(o,h(i),{type:EventEmitter.event.all})},EventEmitter.prototype.emit=function(t){var e,n,o,i,r,p,l=this._routes[t],s=[];if(l){for(var h=0,a=l.length;a>h;h++)e=l[h],i=e.fn,r=e.option,r?(n=r.scope,o=r.type):(n=!1,o=!1),n?i.apply(n,Util.arg2Ary(arguments)):i.apply(this,Util.arg2Ary(arguments)),o&&(o===EventEmitter.event.once?s.push(e):o===EventEmitter.event.all&&s.push(e));if(s.length>0){var v=[],u=0,c=0,E=l.length,f=s.length;for(p=s[c];E>u;)e=l[u],e===p?(c++,p=f>c?s[c]:-1):v.push(e),u++;0===v.length?delete this._routes[t]:this._routes[t]=v}}};