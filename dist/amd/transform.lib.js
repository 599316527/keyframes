define("TFCompatible",["Util","Event","EventEmitter","Compatible"],function(t,e,r,o){function n(){n.superClass.call(this)}return t.inherit(n,r),n.prototype.prefix=o.prefix,n._keyMap={transform:["transform"],transition:["transition"],duration:["transitionDuration","1s"],"function":["transitionTimingFunction","linear"],delay:["transitionDelay","0s"]},n.prototype.parseCSS=function(t){var e=this.prefix.replace(/-/g,"");return n.prototype.parseCSS="moz"===e?function(t){return t in n._keyMap?n._keyMap[t][0]:t}:function(t){return t in n._keyMap?(t=n._keyMap[t][0],e+t[0].toUpperCase()+t.substr(1)):t},this.parseCSS(t)},n.prototype.cssMap=function(t){var e;switch(t){case"transform":e="-webkit-"===this.prefix?this.prefix+t:t;break;case"backgroundColor":e="background-color";break;case"borderRadius":e="border-radius";break;case"fontSize":e="font-size";break;case"color":case"top":case"bottom":case"left":case"width":case"height":case"opacity":case"right":e=t;break;default:throw new Error(t+" not supported!")}return e},n.prototype.peelMould=function(e){var r={};return t.forKey(n._keyMap,function(t){t in e&&(r[t]=e[t])}),r},n.prototype.clone=function(e,r){var o,i=n._keyMap;return e instanceof Array?(o=[],t.each(e,function(t){o.push(this.clone(t,r))},this)):"object"==typeof e?(o={},t.forIn(e,function(t,e){t in i?o[t]=this.clone(e,r):t in r&&("api"in o||(o.api={}),o.api[r[t]]=this.clone(e,r))},this)):o=e,o},n.prototype.parseTransition=function(t){function e(e,r){return r in t?t[r]:n._keyMap[r][1]}return"<property> <duration> <function> <delay>".replace(/<(.*?)>/g,e)},n.instance=function(){return n._compatible||(n._compatible=new n),n._compatible},n.prototype.parseEvent=o.parseEvent("transition","Transition"),n}),define("Transform",["EventEmitter","Util","Compatible","TFCompatible","Event"],function(t,e,r,o,n){function i(t,e){i.superClass.call(this),this._dom=t,this._executeInTime=e,this._steps=[],this._store={},this._index=0,this._compatible=o.instance(),this._listen()}return e.inherit(i,t),i.prototype._listen=function(){function t(t){return function(e){r.emit(t,e)}}var r=this,o=r._compatible;this.on(n.on,function(e,i){i===n.end&&(r._monitorEnd||(r._monitorEnd=t(i),r._on(o.parseEvent(i),r._monitorEnd)))}),this.on(n.end,function(t,i){if(r._index<r._steps.length){var s=r._steps[r._index],a=i.propertyName.replace(o.prefix,"");if(a in s.status){s.status[a]=!0;var p=s.status,c=e.forIn(p,function(t,e){return e?void 0:!1});c&&(r._index++,s.next?(r.emit(n.next,s),s.next()):r.emit(n.over,s))}}e.stopPropagation(i)})},i.prototype._combineTransform=function(t,r){var o=e.css(this._dom,r);return o&&"none"!==o?o+" "+t.join(" "):t.join(" ")},i.prototype.setExecuteInTime=function(t){return this._executeInTime=t,this},i.prototype.moveBy=function(t){var e=i._apiMap.moveBy;return this._transform(t,e),this},i.prototype.then=function(t){var e=this._steps.length;if(e>0){var r=this._steps[e-1],o=r.next;r.next=o?function(){o(),t()}:t}else t();return this},i.prototype._step=function(t,r,o){var n=this,i=n._compatible,s={},a=n._steps.length;if(a>0){var p=n._steps[a-1],c=p.next;c?(p.next=function(){c(),e.css(n._dom,i.parseCSS("transition"),t),e.css(n._dom,r())},n._index===n._steps.length&&(e.css(n._dom,i.parseCSS("transition"),t),e.css(n._dom,r()))):(p.next=function(){e.css(n._dom,i.parseCSS("transition"),t),e.css(n._dom,r())},n._index===n._steps.length&&p.next())}else s.execute=function(){e.css(n._dom,i.parseCSS("transition"),t),e.css(n._dom,r())},this._executeInTime&&s.execute();s.status=o,s.next=!1,this._steps.push(s)},i.prototype.reStore=function(){e.css(this._dom,this._store);for(var t;this._index>0;)this._index--,t=this._steps[this._index].status,e.forKey(t,function(e){t[e]=!1});return this},i.prototype.reflow=function(){return r.reflow(this._dom),this},i.prototype.reExecute=function(){return this.reStore().reflow(),this.execute()},i.prototype.execute=function(){if(this._index<this._steps.length){var t=this._steps[this._index];"execute"in t&&t.execute()}return this},i.prototype._transform=function(t,e){var r=this,o=r._compatible,n=o.cssMap("transform"),i=[];t=this._fillTransformParams(t,e,i);var s={};s.transform=!1,t.property=n,this._step(o.parseTransition(t),function(){var t={},e=o.parseCSS("transform");return t[e]=r._combineTransform(i,e),t},s)},i.prototype._fillTransformParams=function(t,r,o){var n=this._compatible,i=n.parseCSS("transform"),s=n.parseCSS("transition");t=n.clone(t,r);var a=t.api;if(!a)throw new Error("不健全的配置项！");return e.forIn(a,function(t,e){o.push(t+"("+e+")")}),i in this._store||(this._store[i]=e.css(this._dom,i)),s in this._store||(this._store[s]=e.css(this._dom,s)),t},i.prototype.scaleBy=function(t){var e=i._apiMap.scaleBy;return this._transform(t,e),this},i._apiMap={changeTo:{c:"color",bc:"backgroundColor",fs:"fontSize",br:"borderRadius",o:"opacity",l:"left",r:"right",t:"top",b:"bottom",w:"width",h:"height"},moveTo:{t:"top",l:"left",b:"bottom",r:"right"},moveBy:{x:"translateX",y:"translateY",z:"translateZ","2d":"translate","3d":"translate3d"},scaleBy:{x:"scaleX",y:"scaleY",z:"scaleZ","2d":"scale","3d":"scale3d"},rotateBy:{x:"rotateX",y:"rotateY",z:"rotateZ","3d":"rotate3d"},skewBy:{x:"skewX",y:"skewY","2d":"skew"}},i.prototype.skewBy=function(t){var e=i._apiMap.skewBy;return this._transform(t,e),this},i.prototype.rotateBy=function(t){var e=i._apiMap.rotateBy;return this._transform(t,e),this},i.prototype.mix=function(t){var r,o=this._compatible.peelMould(t),n=[],s={},a={},p=[],c=0;e.forIn(i._apiMap,function(i,f){i in t&&(r=t[i],"moveTo"===i||"changeTo"===i?(r instanceof Array||(r=[r]),e.each(r,function(t){e.extend(t,o)}),this._fillCSSParams(r,f,n,s,a)):(this._fillTransformParams(r,f,p),c++))},this);var f=this,u=f._compatible;if(c>0){var h=u.cssMap("transform");a.transform=!1,t.property=h,n.push(u.parseTransition(t))}return this._step(n.join(","),function(){if(c>0){var t=u.parseCSS("transform");s[t]=f._combineTransform(p,t)}return s},a),this},i.prototype.moveTo=function(t){var e=i._apiMap.moveTo;return this._css(t,e),this},i.prototype.changeTo=function(t){var e=i._apiMap.changeTo;return this._css(t,e),this},i.prototype._addStatus=function(t,e){var r=this._compatible.cssMap(e);return"border-radius"===r?(t["border-bottom-left-radius"]=!1,t["border-top-left-radius"]=!1,t["border-bottom-right-radius"]=!1,t["border-top-right-radius"]=!1):t[r]=!1,r},i.prototype._css=function(t,e){var r=[],o={},n={};this._fillCSSParams(t,e,r,o,n),this._step(r.join(","),function(){return o},n)},i.prototype._fillCSSParams=function(t,r,o,n,i){var s,a=this,p=a._compatible.parseCSS("transition");t=a._compatible.clone(t,r),t instanceof Array||(t=[t]),e.each(t,function(t){if(!t.api)throw new Error("不健全的配置！");e.forIn(t.api,function(r,c){s=this._addStatus(i,r),n[r]=c,r in this._store||(this._store[r]=e.css(this._dom,r)),p in this._store||(this._store[p]=e.css(this._dom,p)),t.property=s,o.push(a._compatible.parseTransition(t))},a)})},i.prototype._on=function(t,r){e.on(this._dom,t,r)},i.prototype._off=function(t,r){e.off(this._dom,t,r)},i.prototype._unListen=function(){this._monitorStart&&this._off(this._compatible.parseEvent(n.start),this._monitorStart),this._monitorEnd&&this._off(this._compatible.parseEvent(n.end),this._monitorEnd)},i.prototype.perspective=function(t){var r=this._compatible,o=this._dom.parentNode;return t===!1?e.css(o,r.parseCSS("transformStyle"),"flat"):(e.css(o,r.parseCSS("transformStyle"),"preserve-3d"),e.css(o,r.parseCSS("perspective"),t)),this},i});