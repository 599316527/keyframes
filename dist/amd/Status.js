define(["Util"],function(t){function i(){this.init(),this.sep="|",this.size=0,this.store=[]}return i.prototype.init=function(){this.all={},this.once={},this.addUp=0},i.prototype.add=function(t,i,e){this.all[t]=!1;var s=this.sep;i&&(this.once[t]=s+i.join(s+s)+s),e||(this.store.push({all:t,once:i}),this.size++)},i.prototype.reset=function(){this.init(),t.each(this.store,function(t){this.add(t.all,t.once,!0)},this)},i.prototype.isDone=function(){return this.size===this.addUp},i.prototype.digest=function(i){var e=this.all,s=this.once,n=this.sep;i in e?(e[i]=!0,delete s[i],this.addUp++):t.forIn(s,function(t,o){return o=o.replace(n+i+n,""),s[t]=o,""===o?(e[i]=!0,this.addUp++,delete s[i],!1):void 0},this)},i});