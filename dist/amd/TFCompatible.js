define(["Util","Event","EventEmitter","Compatible"],function(r,t,e,o){function i(){i.superClass.call(this)}return r.inherit(i,e),i.prototype.prefix=o.prefix,i._keyMap={transform:["transform"],transition:["transition"],duration:["transitionDuration","1s"],"function":["transitionTimingFunction","linear"],delay:["transitionDelay","0s"]},i.prototype.parseCSS=function(r){var t=this.prefix.replace(/-/g,"");return i.prototype.parseCSS="moz ms".indexOf(t)>-1?function(r){return r in i._keyMap?i._keyMap[r][0]:r}:function(r){return r in i._keyMap?(r=i._keyMap[r][0],t+r[0].toUpperCase()+r.substr(1)):r},this.parseCSS(r)},i.prototype.cssMap=function(r){var t;switch(r){case"transform":t="-webkit-"===this.prefix?this.prefix+r:r;break;case"backgroundColor":t="background-color";break;case"borderRadius":t="border-radius";break;case"fontSize":t="font-size";break;case"color":case"top":case"bottom":case"left":case"width":case"height":case"opacity":case"border":case"right":t=r;break;default:throw new Error(r+" not supported!")}return t},i.prototype.addStatus=function(r,t){var e=this.cssMap(t);return"border-radius"===e?(r["border-bottom-left-radius"]=!1,r["border-top-left-radius"]=!1,r["border-bottom-right-radius"]=!1,r["border-top-right-radius"]=!1):"border"===e?(r["border-left-width"]=!1,r["border-top-width"]=!1,r["border-right-width"]=!1,r["border-bottom-width"]=!1,r["border-left-color"]=!1,r["border-top-color"]=!1,r["border-right-color"]=!1,r["border-bottom-color"]=!1):r[e]=!1,e},i.prototype.peelMould=function(t){var e={};return r.forKey(i._keyMap,function(r){r in t&&(e[r]=t[r])}),e},i.prototype.clone=function(t,e){var o,n=i._keyMap;return t instanceof Array?(o=[],r.each(t,function(r){o.push(this.clone(r,e))},this)):"object"==typeof t?(o={},r.forIn(t,function(r,t){t&&(r in n?o[r]=this.clone(t,e):r in e&&("api"in o||(o.api={}),o.api[e[r]]=this.clone(t,e)))},this)):o=t,o},i.prototype.parseTransition=function(r){function t(t,e){return e in r?r[e]:i._keyMap[e][1]}return"<property> <duration> <function> <delay>".replace(/<(.*?)>/g,t)},i.instance=function(){return i._compatible||(i._compatible=new i),i._compatible},i.prototype.parseEvent=o.parseEvent("transition","Transition"),i});