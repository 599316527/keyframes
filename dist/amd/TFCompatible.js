define(["Util","Event","EventEmitter","Compatible"],function(t,r,e,o){function n(){n.superClass.call(this)}return t.inherit(n,e),n.prototype.prefix=o.prefix,n._keyMap={transform:["transform"],transition:["transition"],duration:["transitionDuration","1s"],"function":["transitionTimingFunction","linear"],delay:["transitionDelay","0s"]},n.prototype.parseCSS=function(t){var r=this.prefix.replace(/-/g,"");return n.prototype.parseCSS="moz ms".indexOf(r)>-1?function(t){return t in n._keyMap?n._keyMap[t][0]:t}:function(t){return t in n._keyMap?(t=n._keyMap[t][0],r+t[0].toUpperCase()+t.substr(1)):t},this.parseCSS(t)},n.prototype.cssMap=function(t){var r;switch(t){case"transform":r="-webkit-"===this.prefix?this.prefix+t:t;break;case"backgroundColor":r="background-color";break;case"borderRadius":r="border-radius";break;case"fontSize":r="font-size";break;case"color":case"top":case"bottom":case"left":case"width":case"height":case"opacity":case"border":case"right":r=t;break;default:throw new Error(t+" not supported!")}return r},n.prototype.eventMap={"border-radius":["border-bottom-left-radius","border-top-left-radius","border-bottom-right-radius","border-top-right-radius"],border:["border-left-width","border-top-width","border-right-width","border-bottom-width","border-left-color","border-top-color","border-right-color","border-bottom-color"]},n.prototype.addStatus=function(t,r){var e=this.cssMap(r);return e in this.eventMap?t.add(e,this.eventMap[e]):t.add(e),e},n.prototype.peelMould=function(r){var e={};return t.forKey(n._keyMap,function(t){t in r&&(e[t]=r[t])}),e},n.prototype.clone=function(r,e){var o,i=n._keyMap;return r instanceof Array?(o=[],t.each(r,function(t){o.push(this.clone(t,e))},this)):"object"==typeof r?(o={},t.forIn(r,function(t,r){r&&(t in i?o[t]=this.clone(r,e):t in e&&("api"in o||(o.api={}),o.api[e[t]]=this.clone(r,e)))},this)):o=r,o},n.prototype.parseTransition=function(t){function r(r,e){return e in t?t[e]:n._keyMap[e][1]}return"<property> <duration> <function> <delay>".replace(/<(.*?)>/g,r)},n.instance=function(){return n._compatible||(n._compatible=new n),n._compatible},n.prototype.parseEvent=o.parseEvent("transition","Transition"),n});