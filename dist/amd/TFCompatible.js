define(["Util","Event","EventEmitter","Compatible"],function(t,r,e,o){function n(){n.superClass.call(this),this.convertMap={}}return t.inherit(n,e),n.prototype.prefix=o.prefix,n._keyMap={transform:["transform"],transition:["transition"],duration:["transitionDuration","1s"],"function":["transitionTimingFunction","linear"],delay:["transitionDelay","0s"]},n.prototype.parseCSS=function(t){t in n._keyMap&&(t=n._keyMap[t][0]);var r=document.getElementsByTagName("body")[0];if("undefined"!=typeof r.style[t])return t;var e=this.prefix.replace(/-/g,"");return e+t[0].toUpperCase()+t.substr(1)},n.prototype.cssMap=function(t){if(!(t in this.convertMap)){var r=document.getElementsByTagName("body")[0],e=t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});"undefined"==typeof r.style[t]&&(e=this.prefix+e),this.convertMap[t]=e}return this.convertMap[t]},n.prototype.eventMap={"border-radius":["border-bottom-left-radius","border-top-left-radius","border-bottom-right-radius","border-top-right-radius"],border:["border-left-width","border-top-width","border-right-width","border-bottom-width","border-left-color","border-top-color","border-right-color","border-bottom-color"]},n.prototype.addStatus=function(t,r){var e=this.cssMap(r);return e in this.eventMap?t.add(e,this.eventMap[e]):t.add(e),e},n.prototype.peelMould=function(r){var e={};return t.forIn(n._keyMap,function(t){t in r&&(e[t]=r[t])}),e},n.prototype.clone=function(r,e){var o,i=n._keyMap;return r instanceof Array?(o=[],t.each(r,function(t){o.push(this.clone(t,e))},this)):"object"==typeof r?(o={},t.forIn(r,function(t,r){t in i?o[t]=this.clone(r,e):t in e&&("api"in o||(o.api={}),o.api[e[t]]=this.clone(r,e))},this)):o=r,o},n.prototype.parseTransition=function(t){function r(r,e){return e in t?t[e]:n._keyMap[e][1]}return"<property> <duration> <function> <delay>".replace(/<(.*?)>/g,r)},n.instance=function(){return n._compatible||(n._compatible=new n),n._compatible},n.prototype.parseEvent=o.parseEvent("transition","Transition"),n});