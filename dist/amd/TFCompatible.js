define(["Util","Event","EventEmitter","Compatible"],function(t,e,n,r){function i(){i.superClass.call(this)}return t.inherit(i,n),i.prototype.prefix=r.prefix,i._keyMap={transform:["transform"],transition:["transition"],duration:["transitionDuration","1s"],"function":["transitionTimingFunction","linear"],delay:["transitionDelay","0s"]},i.prototype.parseCSS=function(t){var e=this.prefix.replace(/-/g,"");return i.prototype.parseCSS="moz ms".indexOf(e)>-1?function(t){return t in i._keyMap?i._keyMap[t][0]:t}:function(t){return t in i._keyMap?(t=i._keyMap[t][0],e+t[0].toUpperCase()+t.substr(1)):t},this.parseCSS(t)},i.prototype.cssMap=function(t){var e;switch(t){case"transform":e="-webkit-"===this.prefix?this.prefix+t:t;break;case"backgroundColor":e="background-color";break;case"borderRadius":e="border-radius";break;case"fontSize":e="font-size";break;case"color":case"top":case"bottom":case"left":case"width":case"height":case"opacity":case"right":e=t;break;default:throw new Error(t+" not supported!")}return e},i.prototype.peelMould=function(e){var n={};return t.forKey(i._keyMap,function(t){t in e&&(n[t]=e[t])}),n},i.prototype.clone=function(e,n){var r,o=i._keyMap;return e instanceof Array?(r=[],t.each(e,function(t){r.push(this.clone(t,n))},this)):"object"==typeof e?(r={},t.forIn(e,function(t,e){e&&(t in o?r[t]=this.clone(e,n):t in n&&("api"in r||(r.api={}),r.api[n[t]]=this.clone(e,n)))},this)):r=e,r},i.prototype.parseTransition=function(t){function e(e,n){return n in t?t[n]:i._keyMap[n][1]}return"<property> <duration> <function> <delay>".replace(/<(.*?)>/g,e)},i.instance=function(){return i._compatible||(i._compatible=new i),i._compatible},i.prototype.parseEvent=r.parseEvent("transition","Transition"),i});