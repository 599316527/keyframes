<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>API DOC</title>
    <link rel="SHORTCUT ICON" href="http://www.baidu.com/favicon.ico">
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="dist/lib.min.js"></script>
    <script src="lib/mustache.compiled.js"></script>
    <script type="text/html" id="template">
        {{#doc}}
        <h3>{{title}}</h3>
        <table class="table table-bordered table-hover">
            <thead>
            <tr>
                <th>#</th>
                <th>元数据</th>
                <th>css样式</th>
                <th>说明</th>
            </tr>
            </thead>
            <tbody>
            {{#module}}
            {{#list}}
            <tr class="{{class}}" data-css="{{css}}" data-title="{{title}}">
                <th scope="row">{{@index}}</th>
                <td>{{meta}}</td>
                <td>{{css}}</td>
                <td>{{{notify}}}</td>
            </tr>
            {{/list}}
            {{/module}}
            </tbody>
        </table>
        {{/doc}}
    </script>
    <style>

        .api {
            margin-left: 30px;
            width: 950px;
            min-width: 70%;
        }
        .api td {
            cursor: pointer;
            word-break: break-all;
            word-wrap: break-word;
        }
        .page-header {
            text-align: center;
            width: 96%;
            margin: auto;
            border: none;
        }
        em {
            color: #ffffff;
            position: absolute;
            left: 130px;
            top: 130px;
            font-size: 40px;
        }
        #after {
            background-color: black;
        }
        #after em {
            left: 60px;
            top: 80px;
        }
        /* 3d转换中掉所有元素都应该为absolute布局，从所在空间点(0,0)点开始变换*/
        .space {
            position: absolute;
        }
    </style>
</head>
<body>
<div class="page-header">
    <h1>Keyframes Animation API DOC<small style="margin-left: 20px;"><a target="_blank" href="example/doc.html" style="cursor: pointer;">write & compile in time</a></small></h1>
</div>
<div class="api">
    <script>
        var table = {
            doc: [{
                title: '1. 动画配置项',
                module: [{
                    class: 'info',
                    list: [{
                        meta: '{"translateX":"50px"}'
                    }, {
                        meta: '{"translateY":"50px"}'
                    }, {
                        meta: '{"translateZ":"100px"}'
                    }, {
                        meta: '{"translate":"-50px, -50px"}'
                    }, {
                        meta: '{"translate3d":"50px, 50px, -150px"}'
                    }]
                }, {
                    class: 'success',
                    list: [{
                        meta: '{"rotateX":"120deg"}'
                    }, {
                        meta: '{"rotateY":"120deg"}'
                    }, {
                        meta: '{"rotateZ":"120deg"}',
                        notify: 'rotateZ()函数让元素顺时针或逆时针旋转'
                    }, {
                        meta: '{"rotate":"120deg"}',
                        notify: '效果和rotate()效果等同,不是在2D平面的旋转'
                    }, {
                        meta: '{"rotate3d":"1, 1, 1, 120deg"}'
                    }]
                }, {
                    class: 'warning',
                    list: [{
                        meta: '{"skewX":"30deg"}'
                    }, {
                        meta: '{"skewY":"30deg"}'
                    }, {
                        meta: '{"skew":"30deg, 60deg"}',
                        notify: 'skew存在兼容性问题，建议使用skewX＋skewY组合，<br>skew没有3d转换,目前无Z轴倾斜'
                    }]
                }, {
                    class: 'danger',
                    list: [{
                        meta: '{"scaleX":"2"}'
                    }, {
                        meta: '{"scaleY":"2"}'
                    }, {
                        meta: '{"scaleZ":"200"}',
                        notify: '从z轴看去，scaleZ没有效果，从y轴看去scaleY没有效果'
                    }, {
                        meta: '{"scale":"2, 1.6"}',
                        notify: ''
                    }, {
                        meta: '{"scale3d":"1, 1, 2", "rotateX":"30deg"}',
                        notify: '需要配合其他变形才会有效果'
                    }]
                }, {
                    class: 'active',
                    list: [{
                        meta: '{"transform": "translateY(10px) rotateY(60deg)"}',
                        notify: '支持以上所有配置项，需要注意:<br>translateY(10px) rotateX(10deg) !== rotateX(10deg) translateY(10px)'
                    }]
                }]
            }, {
                title: '2. 基准配置项',
                module: [{
                    class: 'info',
                    list: [{
                        meta: '{"perspective":"250px"}'
                    }, {
                        meta: '{"perspective-origin":"30% 80%"}'
                    }, {
                        meta: '{"transform-style":"flat"}',
                        notify: '对于嵌套的dom结构，父元素都需要设置preserve-3d,<br>在根元素设置只会影响直接子元素，且会影响到间接子元素'
                    }, {
                        meta: '{"transform-origin":"20% 50%"}'
                    }]
                }]
            },{
                title: '3. 必要配置项',
                module: [{
                    class: 'warning',
                    list: [{
                        meta: '{"backface-visibility":"hidden"}',
                        notify: 'visible || hidden'
                    },{
                        meta: '{"position":"absolute"}',
                        notify: '3d转换中掉所有元素都应该为absolute布局，从所在空间点(0,0)点开始变换,清除static定位产生的影响'
                    }]
                },]
            }]
        };
        var cpl = Compiler.instance();
        Util.each(table.doc, function(item) {
            Util.each(item.module, function(item) {
                Util.each(item.list, function(item) {
                    item.css = cpl._compileContent(JSON.parse(item.meta));
                    item.meta = item.meta.replace(/[{}]/g, '');
                });
            });
        });
        $('.api').delegate('tr', 'click', function() {
            var me = $(this);
            var title = me.attr('data-title');
            switch (title) {
                case table.doc[0].title:
                    $('#after').attr('style', $(this).attr('data-css'));
                    break;
                case table.doc[1].title:
                    $('.scene').attr('style', $(this).attr('data-css'));
                    break;
                case table.doc[2].title:
                    $('#after').attr('style', $('#after').attr('style') + $(this).attr('data-css'));
                    break;
            }
        });
        document.write(Mustache.render(document.getElementById('template').innerHTML, table));
    </script>
</div>
<script>
    Keyframe.defineClass('scene', {
        'transform-style': 'preserve-3d',
        'scale': '1.3, 1.3',
        'perspective': '400px',
        'width': '700px',
        'height': '600px',
        //'border': '1px dotted black',
        'perspective-origin': '70% 55%',
        'position': 'fixed',
        'right': '-150px',
        'top': '80px',
        'transition': 'transform 2s, perspective-origin 2s, perspective 2s, transform-origin 2s'
    });
    Keyframe.defineClass('p3d', {
        'transform-style': 'preserve-3d',
        'width': '500px',
        'height': '500px',
        'rotateX': '90deg',
        'translateZ': '-300px',
        'translateX': '100px'
    });
    Keyframe.defineClass('zuobiao', {
        'width': '500px',
        'height': '500px',
        'transform-style': 'preserve-3d',
        'backface-visibility': 'visible'
    });
    Keyframe.defineClass('wall', {
        'width': '300px',
        'height': '300px',
        'opacity': 0.5,
        'border': '1px solid black'
    });
    Keyframe.defineClass('y', {
        'background-color': 'red',
        'transform-origin': 'bottom',
        'translateY': '-300px',
        'translateZ': '300px',
        'rotateX': '90deg'
    });
    Keyframe.defineClass('x', {
        'background-color': 'green',
        'transform-origin': 'right',
        'translateX': '-300px',
        'rotateY': '90deg'
    });
    Keyframe.defineClass('z', {
        'background-color': 'blue'
    });
    Keyframe.defineClass('demo', {
        'width': '300px',
        'height': '300px',
        'translateY': '50px',
        'translateZ': '150px',
        'translateX': '50px',
        'transform-style': 'preserve-3d',
        'backface-visibility': 'visible'
    });
    Keyframe.defineClass('target', {
        'width': '200px',
        'height': '200px',
        'background-color': 'gray',
        'border': '1px solid black',
        'transition': 'transform 2s',
        'backface-visibility': 'visible'
    });
    Keyframe.compile();
</script>
<div class="scene">
<div class="p3d space">
    <div class="zuobiao space">
        <div class="z wall space"><em>Z</em></div>
        <div class="x wall space"><em>X</em></div>
        <div class="y wall space"><em>Y</em></div>
    </div>
    <div class="demo space">
        <div id="before" class="target space"></div>
        <div id="after" class="target space"><em>炫动</em></div>
    </div>
</div>
</div>
</body>
</html>